#:kivy 2.3.0

<LoginScreen>:
    username: username
    password: password
    BoxLayout:
        orientation: "vertical"
        padding: 20
        spacing: 10
        Label:
            text: "GeekShop - Login"
            font_size: 28
        TextInput:
            id: username
            hint_text: "Usuário"
            multiline: False
        TextInput:
            id: password
            hint_text: "Senha"
            multiline: False
            password: True
        BoxLayout:
            size_hint_y: None
            height: 40
            Button:
                text: "Entrar"
                on_release: root.do_login()
            Button:
                text: "Registrar"
                on_release: app.root.current = "register"

<RegisterScreen>:
    username: username
    password: password
    name: name
    email: email
    BoxLayout:
        orientation: "vertical"
        padding: 20
        spacing: 8
        Label:
            text: "Registrar Conta"
            font_size: 24
        TextInput:
            id: username
            hint_text: "Usuário"
            multiline: False
        TextInput:
            id: password_input
            hint_text: "Senha"
            password: True
            multiline: False
        TextInput:
            id: name_input
            hint_text: "Nome"
            multiline: False
        TextInput:
            id: email_input
            hint_text: "Email"
            multiline: False
        Button:
            text: "Cadastrar"
            on_release: root.do_register()
        Button:
            text: "Voltar para Login"
            size_hint_y: None
            height: 40
            on_release: app.root.current = "login"

<HomeScreen>:
    products_list: products_list
    search_input: search_input
    BoxLayout:
        orientation: "vertical"
        padding: 10
        spacing: 8
        BoxLayout:
            size_hint_y: None
            height: 48
            TextInput:
                id: search_input
                hint_text: "Pesquisar produtos..."
                multiline: False
            Button:
                text: "Buscar"
                on_release: root.do_search()
            Button:
                text: "Carrinho"
                on_release: app.root.current = "cart"
            Button:
                text: "Perfil"
                on_release: app.root.current = "profile"
        Label:
            text: "Produtos em destaque"
            size_hint_y: None
            height: 30
        ScrollView:
            GridLayout:
                id: products_list
                cols: 1
                size_hint_y: None
                height: self.minimum_height
                spacing: 6

<ProductItem>:
    orientation: "horizontal"
    size_hint_y: None
    height: 100
    padding: 6
    Image:
        source: root.image if root.image else ""
        size_hint_x: 0.3
    BoxLayout:
        orientation: "vertical"
        Label:
            text: root.title
            halign: "left"
            valign: "middle"
            text_size: self.size
        Label:
            text: f"R$ {root.price:.2f}"
        BoxLayout:
            size_hint_y: None
            height: 36
            Button:
                text: "Ver"
                on_release: root.view_detail()

<DetailScreen>:
    title: title
    desc: desc
    price: price
    image: image
    qty: qty
    BoxLayout:
        orientation: "vertical"
        padding: 10
        spacing: 8
        BoxLayout:
            size_hint_y: None
            height: 40
            Button:
                text: "Voltar"
                on_release: app.root.current = "home"
            Button:
                text: "Carrinho"
                on_release: app.root.current = "cart"
        Label:
            id: title
            text: ""
            font_size: 22
        Image:
            id: image
            source: ""
            size_hint_y: None
            height: 200
        Label:
            id: price
            text: ""
        Label:
            id: desc
            text: ""
        BoxLayout:
            size_hint_y: None
            height: 40
            TextInput:
                id: qty
                text: "1"
                multiline: False
                input_filter: "int"
            Button:
                text: "Adicionar ao Carrinho"
                on_release: root.add_to_cart()
            Button:
                text: "Comprar agora"
                on_release: root.buy_now()

<CartScreen>:
    cart_list: cart_list
    total_label: total_label
    BoxLayout:
        orientation: "vertical"
        padding: 10
        spacing: 8
        BoxLayout:
            size_hint_y: None
            height: 40
            Button:
                text: "Voltar"
                on_release: app.root.current = "home"
            Button:
                text: "Perfil"
                on_release: app.root.current = "profile"
        Label:
            text: "Seu Carrinho"
            size_hint_y: None
            height: 30
        ScrollView:
            GridLayout:
                id: cart_list
                cols: 1
                size_hint_y: None
                height: self.minimum_height
                spacing: 6
        Label:
            id: total_label
            text: "Total: R$ 0.00"
            size_hint_y: None
            height: 30
        BoxLayout:
            size_hint_y: None
            height: 40
            Button:
                text: "Finalizar Compra"
                on_release: root.finalize()

<CartItem>:
    orientation: "horizontal"
    size_hint_y: None
    height: 100
    Image:
        source: root.image if root.image else ""
        size_hint_x: 0.25
    BoxLayout:
        orientation: "vertical"
        Label:
            text: root.title
            text_size: self.size
        Label:
            text: f"R$ {root.price:.2f} x {root.qty}"
        BoxLayout:
            size_hint_y: None
            height: 36
            Button:
                text: "Remover"
                on_release: root.remove()

<ProfileScreen>:
    name: name
    email: email
    cpf: cpf
    rg: rg
    cep: cep
    endereco: endereco
    avatar: avatar
    password: password
    username_label: username_label
    BoxLayout:
        orientation: "vertical"
        padding: 10
        spacing: 8
        BoxLayout:
            size_hint_y: None
            height: 40
            Button:
                text: "Voltar"
                on_release: app.root.current = "home"
            Button:
                text: "Sair"
                on_release: app.root.current = "logout"
        Label:
            id: username_label
            text: ""
            size_hint_y: None
            height: 30
        GridLayout:
            cols: 2
            size_hint_y: None
            height: 260
            spacing: 6
            BoxLayout:
                orientation: "vertical"
                Label:
                    text: "Nome"
                TextInput:
                    id: name
                Label:
                    text: "Email"
                TextInput:
                    id: email
                Label:
                    text: "Senha (preencha para trocar)"
                TextInput:
                    id: password
                    password: True
                Label:
                    text: "CPF"
                TextInput:
                    id: cpf
            BoxLayout:
                orientation: "vertical"
                Label:
                    text: "RG"
                TextInput:
                    id: rg
                Label:
                    text: "CEP"
                TextInput:
                    id: cep
                Label:
                    text: "Endereço"
                TextInput:
                    id: endereco
                Label:
                    text: "Avatar (caminho da imagem)"
                Image:
                    id: avatar
                    source: ""
                    size_hint_y: None
                    height: 120
        Button:
            text: "Salvar Perfil"
            size_hint_y: None
            height: 40
            on_release: root.save_profile()

<LogoutScreen>:
    BoxLayout:
        Label:
            text: "Saindo..."
